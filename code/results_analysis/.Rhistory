plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"),
legend.text = element_text(size = 16),
legend.title = element_text(size = 18))
ggsave(paste0("Fig6.png"), fig6, width = 10, height = 10)
fig6 <- free(scatterplot_AUC) / (p_umap | p_AUC_He) +
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16))
ggsave(paste0("Fig6.png"), fig6, width = 10, height = 10)
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
fig6 <- free(scatterplot_AUC) / free(p_umap | p_AUC_He) +
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16))
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
fig6 <- free(scatterplot_AUC) / ((p_umap | p_AUC_He) & theme(
legend.text = element_text(size = 13),
legend.title = element_text(size = 15))) +
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"))
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
classes = c("Micro-average", "0", "1", "2")
myColors <- c("black", "#FF0000", "#008000", "#0000FF")
names(myColors) <- classes
myLinetypes <- c("solid", rep("dashed", 3))
names(myLinetypes) <- classes
s1 <- gsub(".csv", "",f1)
params_1 <- as.data.frame(t(str_split(s1, pattern = "_")[[1]][-1]))
p1 <- read.csv(file.path(pred_dir, f1), check.names = F)
params <- params_1[rep(1, each = nrow(p1)),]
pred <- rbind(pred, cbind(params, p1))
colnames(pred)[1:7] <- c("basemodel", "image", "optimizer", "batch_size", "learning_rate",
"dropout_rate", "dense_layer_size")
pred$label.pred <- factor(pred$label.pred)
pred$Prediction <- pred$label.pred
pred_true <- merge(df, pred, by = "X")
y_scores <- pred_true[,(ncol(pred_true)-3):(ncol(pred_true)-1)]
colnames(y_scores) <- paste0(colnames(y_scores), "_pred_NN")
y_onehot <- fastDummies::dummy_cols(pred_true[,"integrated.cca.lognorm_clusters_0.1"])
colnames(y_onehot) <- c('drop', gsub(".data_", "", colnames(y_onehot)[-1]))
y_onehot <- subset(y_onehot, select = -c(drop))
class = colnames(y_onehot)
colnames(y_onehot) <- paste0(colnames(y_onehot),"_true")
z = cbind(y_onehot, y_scores)
roc <- multi_roc(z)
auc <- as.data.frame(roc$AUC$NN) %>%
t() %>%
as.data.frame() %>%
rownames_to_column()
colnames(auc) <- c("class", "AUC")
AUC_df <- cbind(params_1, auc)
plot_roc_df <- plot_roc_data(roc)
plot_roc_df <- plot_roc_df[plot_roc_df$Group != "Macro", ] # remove Macro
plot_roc_df$Group <- ifelse(plot_roc_df$Group == "Micro", "Micro-average", plot_roc_df$Group)
plot_roc_df$Legend <- ifelse(plot_roc_df$Group == "Micro-average", paste0(plot_roc_df$Group, ' (AUC = ', round(plot_roc_df$AUC,3), ')'),
paste0("Cluster ", plot_roc_df$Group, ' (AUC = ', round(plot_roc_df$AUC,3), ')'))
order <- match( c("Micro-average", class), sort(unique(plot_roc_df$Group)))
plot_roc_df$Legend <- factor(plot_roc_df$Legend,
levels = sort(unique(plot_roc_df$Legend))[order])
plot_roc_df$Group <- factor(plot_roc_df$Group, levels = c("Micro-average", class))
plot_roc_df$Type <- ifelse(plot_roc_df$Group %in% c("Micro-average"), "1", "0")
group_order <- levels(plot_roc_df$Group)
names(group_order) <- levels(plot_roc_df$Legend)
colScale <- scale_colour_manual(name = "Class (AUC)",
values = myColors,
breaks = group_order,
labels = names(group_order))
linetype_order <- levels(plot_roc_df$Group)
names(linetype_order) <- levels(plot_roc_df$Legend)
linetypeScale <- scale_linetype_manual(name = "Class (AUC)",
values = myLinetypes,
breaks = linetype_order,
labels = names(linetype_order))
title <- paste0(gsub("pred_", "", s1))
p_AUC_He <- ggplot(plot_roc_df,
aes(x = 1-Specificity, y=Sensitivity)) +
geom_path(aes(color = Group, linetype = Group), size = 0.7) +
geom_segment(aes(x = 0, y = 0, xend = 1, yend = 1),
colour='black', linetype = 'dashed', size = 0.7) +
labs(x = "False Positive Rate",
y = "True Positive Rate",
title = "",
color = "") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 17),
legend.justification=c(1, 0),
legend.position=c(.98, .02),
legend.title=element_blank(),
legend.text = element_text(size = 12),
legend.key.width = unit(1, 'cm'),
legend.background = element_rect(fill="transparent",
size=0.5,
linetype="solid",
colour ="black"),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 15))  +
colScale +
linetypeScale
fig6 <- free(scatterplot_AUC) / (p_umap | p_AUC_He) +
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16))
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
p_AUC_He <- ggplot(plot_roc_df,
aes(x = 1-Specificity, y=Sensitivity)) +
geom_path(aes(color = Group, linetype = Group), size = 0.7) +
geom_segment(aes(x = 0, y = 0, xend = 1, yend = 1),
colour='black', linetype = 'dashed', size = 0.7) +
labs(x = "False Positive Rate",
y = "True Positive Rate",
title = "",
color = "",
linetype = "") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 17),
legend.justification=c(1, 0),
legend.position=c(.98, .02),
legend.title=element_blank(),
legend.text = element_text(size = 12),
legend.key.width = unit(1, 'cm'),
legend.background = element_rect(fill="transparent",
size=0.5,
linetype="solid",
colour ="black"),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 15))  +
colScale +
linetypeScale
fig6 <- free(scatterplot_AUC) / (p_umap | p_AUC_He) +
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16))
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
p_AUC_He <- ggplot(plot_roc_df,
aes(x = 1-Specificity, y=Sensitivity)) +
geom_path(aes(color = Group, linetype = Group), size = 0.7) +
geom_segment(aes(x = 0, y = 0, xend = 1, yend = 1),
colour='black', linetype = 'dashed', size = 0.7) +
labs(x = "False Positive Rate",
y = "True Positive Rate",
title = "",
color = "",
linetype = "") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 17),
legend.justification=c(1, 0),
legend.position=c(.98, .02),
legend.title=element_blank(),
legend.text = element_text(size = 12),
legend.key.width = unit(1, 'cm'),
legend.background = element_rect(fill="transparent",
size=0.5,
linetype="solid",
colour ="black"),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 15))  +
colScale +
linetypeScale
colScale <- scale_colour_manual(name = "",
values = myColors,
breaks = group_order,
labels = names(group_order))
group_order <- levels(plot_roc_df$Group)
names(group_order) <- levels(plot_roc_df$Legend)
colScale <- scale_colour_manual(name = "",
values = myColors,
breaks = group_order,
labels = names(group_order))
linetype_order <- levels(plot_roc_df$Group)
names(linetype_order) <- levels(plot_roc_df$Legend)
linetypeScale <- scale_linetype_manual(name = "",
values = myLinetypes,
breaks = linetype_order,
labels = names(linetype_order))
title <- paste0(gsub("pred_", "", s1))
p_AUC_He <- ggplot(plot_roc_df,
aes(x = 1-Specificity, y=Sensitivity)) +
geom_path(aes(color = Group, linetype = Group), size = 0.7) +
geom_segment(aes(x = 0, y = 0, xend = 1, yend = 1),
colour='black', linetype = 'dashed', size = 0.7) +
labs(x = "False Positive Rate",
y = "True Positive Rate",
title = "",
color = "",
linetype = "") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 17),
legend.justification=c(1, 0),
legend.position=c(.98, .02),
legend.title=element_blank(),
legend.text = element_text(size = 12),
legend.key.width = unit(1, 'cm'),
legend.background = element_rect(fill="transparent",
size=0.5,
linetype="solid",
colour ="black"),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 15))  +
colScale +
linetypeScale
fig6 <- free(scatterplot_AUC) / (p_umap | p_AUC_He) +
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16))
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
colScale <- scale_colour_manual(name = NULL,
values = myColors,
breaks = group_order,
labels = names(group_order))
linetype_order <- levels(plot_roc_df$Group)
names(linetype_order) <- levels(plot_roc_df$Legend)
linetypeScale <- scale_linetype_manual(name = NULL,
values = myLinetypes,
breaks = linetype_order,
labels = names(linetype_order))
title <- paste0(gsub("pred_", "", s1))
p_AUC_He <- ggplot(plot_roc_df,
aes(x = 1-Specificity, y=Sensitivity)) +
geom_path(aes(color = Group, linetype = Group), size = 0.7) +
geom_segment(aes(x = 0, y = 0, xend = 1, yend = 1),
colour='black', linetype = 'dashed', size = 0.7) +
labs(x = "False Positive Rate",
y = "True Positive Rate",
title = "",
color = "",
linetype = "") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 17),
legend.justification=c(1, 0),
legend.position=c(.98, .02),
legend.title=element_blank(),
legend.text = element_text(size = 12),
legend.key.width = unit(1, 'cm'),
legend.background = element_rect(fill="transparent",
size=0.5,
linetype="solid",
colour ="black"),
axis.text = element_text(size = 13, color = "black"),
axis.title = element_text(size = 15))  +
colScale +
linetypeScale
fig6 <- free(scatterplot_AUC) / (p_umap | p_AUC_He) +
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16))
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
fig6 <- free(scatterplot_AUC) / (p_umap | p_AUC_He) +
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"),
legend.text = element_text(size = 15),
legend.title = element_text(size = 16))
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
fig6 <- free(scatterplot_AUC) / (p_umap | p_AUC_He) +
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16))
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
fig6 <- free(scatterplot_AUC) / (p_umap | p_AUC_He) +
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16),
axis.text = element_text(size = 12),
axis.title = element_text(size = 16))
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
scatterplot_AUC <- scatterplot_AUC +
theme(legend.text = element_text(size = 14),
legend.title = element_text(size = 16),
axis.text = element_text(size = 16))
scatterplot_AUC <- scatterplot_AUC +
theme(axis.text = element_text(size = 16))
scatterplot_AUC <- scatterplot_AUC +
theme(legend.text = element_text(size = 14),
legend.title = element_text(size = 16),
axis.text = element_text(size = 16))
fig6 <- free(scatterplot_AUC) / ((p_umap | p_AUC_He) &
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 16)))+
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16))
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
scatterplot_AUC <- scatterplot_AUC +
theme(legend.text = element_text(size = 16),
legend.title = element_text(size = 18),
axis.text = element_text(size = 16))
fig6 <- free(scatterplot_AUC) / ((p_umap | p_AUC_He) &
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 16)))+
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16))
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
scatterplot_AUC <- scatterplot_AUC +
theme(legend.text = element_text(size = 16),
legend.title = element_text(size = 16),
axis.text.x = element_text(size = 16),
axis.title = element_text(size = 16))
fig6 <- free(scatterplot_AUC) / ((p_umap | p_AUC_He) &
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 16)))+
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16))
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
scatterplot_AUC <- scatterplot_AUC +
theme(legend.text = element_text(size = 16),
legend.title = element_text(size = 16),
axis.text.x = element_text(size = 16),
axis.text.y = element_text(size = 14),
axis.title = element_text(size = 16))
fig6 <- free(scatterplot_AUC) / ((p_umap | p_AUC_He) &
theme(axis.text = element_text(size = 14),
axis.title = element_text(size = 16)))+
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16))
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
scatterplot_AUC <- scatterplot_AUC +
theme(legend.text = element_text(size = 16),
legend.title = element_text(size = 16),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 16),
axis.title = element_text(size = 16))
p_AUC_He
fig6 <- free(scatterplot_AUC) / ((p_umap | p_AUC_He) &
theme(axis.text = element_text(size = 14),
axis.title = element_text(size = 16)))+
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16))
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
scatterplot_AUC <- scatterplot_AUC +
theme(legend.text = element_text(size = 17),
legend.title = element_text(size = 19),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 16),
axis.title = element_text(size = 16))
fig6 <- free(scatterplot_AUC) / ((p_umap | p_AUC_He) &
theme(axis.text = element_text(size = 14),
axis.title = element_text(size = 16)))+
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16))
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
fig6 <- free(scatterplot_AUC) / ((p_umap | p_AUC_He) &
theme(axis.text = element_text(size = 14),
axis.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16)))+
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"))
ggsave(paste0("Fig6.png"), fig6, width = 10.5, height = 10.5)
ggsave(paste0("Fig6.png"), fig6, width = 11, height = 10)
scatterplot_AUC <- scatterplot_AUC +
theme(legend.text = element_text(size = 16),
legend.title = element_text(size = 18),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 16),
axis.title = element_text(size = 16))
p_AUC_He
fig6 <- free(scatterplot_AUC) / ((p_umap | p_AUC_He) &
theme(axis.text = element_text(size = 14),
axis.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16)))+
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"))
ggsave(paste0("Fig6.png"), fig6, width = 11, height = 10)
fig6 <- free(scatterplot_AUC) / ((p_umap | p_AUC_He) &
theme(axis.text = element_text(size = 14),
axis.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16)) +
plot_layout(widths = c(1.2, 0.8)))+
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"))
ggsave(paste0("Fig6.png"), fig6, width = 11, height = 10)
fig6 <- free(scatterplot_AUC) / ((p_umap | p_AUC_He) &
theme(axis.text = element_text(size = 14),
axis.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16)) +
plot_layout(widths = c(1.5, 0.8)))+
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"))
ggsave(paste0("Fig6.png"), fig6, width = 11, height = 10)
fig6 <- free(scatterplot_AUC) / ((p_umap | free(p_AUC_He)) &
theme(axis.text = element_text(size = 14),
axis.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16)) +
plot_layout(widths = c(1.5, 0.8)))+
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"))
ggsave(paste0("Fig6.png"), fig6, width = 11, height = 10)
fig6 <- free(scatterplot_AUC) / ((p_umap | free(p_AUC_He)) &
theme(axis.text = element_text(size = 14),
axis.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16)))+
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"))
ggsave(paste0("Fig6.png"), fig6, width = 11, height = 10)
ggsave(paste0("Fig6.png"), fig6, width = 11.5, height = 10.5)
scatterplot_AUC <- scatterplot_AUC +
theme(legend.text = element_text(size = 15),
legend.title = element_text(size = 16),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 16),
axis.title = element_text(size = 16))
fig6 <- free(scatterplot_AUC) / ((free(p_umap) | free(p_AUC_He)) &
theme(axis.text = element_text(size = 14),
axis.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16)))+
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"))
ggsave(paste0("Fig6.png"), fig6, width = 11.5, height = 10.5)
fig6 <- free(scatterplot_AUC) / ((p_umap | free(p_AUC_He)) &
theme(axis.text = element_text(size = 14),
axis.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16)))+
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"))
ggsave(paste0("Fig6.png"), fig6, width = 11.5, height = 10.5)
fig6 <- free(scatterplot_AUC) / ((p_umap | free(p_AUC_He)) &
theme(axis.text = element_text(size = 14),
axis.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16)))+
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "plain"))
ggsave(paste0("Fig6.png"), fig6, width = 11.5, height = 10.5)
ggsave(paste0("Fig6.png"), fig6, width = 11.5, height = 10.5)
fig6 <- free(scatterplot_AUC) / ((p_umap | free(p_AUC_He)) &
theme(axis.text = element_text(size = 14),
axis.title = element_text(size = 16),
legend.text = element_text(size = 14),
legend.title = element_text(size = 16)))+
plot_annotation(tag_levels = 'A',
tag_prefix = "(",
tag_suffix = ")") &
theme(plot.tag = element_text(size = 16, face = "bold"))
ggsave(paste0("Fig6.png"), fig6, width = 11.5, height = 10.5)
